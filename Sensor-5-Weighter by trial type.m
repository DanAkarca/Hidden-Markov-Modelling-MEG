%% Sensor level analysis: Weighter by trial script
%  Danyal Akarca, MPhil Candidate in Basic and Translational Neuroscience
%% Load grandaveraged dataset
spm('defaults', 'eeg');
cd('/imaging/da04/')
base='/imaging/da04/';%Set this as the folder your work is in
filenames={'mfeAdspm12meg14_0440_140509_task1_raw_mc_oddball.mat',...
           'mfeAdspm12meg14_0440_140509_part2_raw_mc_oddball.mat',...
           'mfeAdspm12meg14_0432_140218_TaskBlock2_raw_mc_oddball.mat',...
           'mfeAdspm12meg14_0432_140218_TaskBlock1_raw_mc_oddball.mat',...
           'mfeAdspm12meg14_0431_140218_TaskBlock2_raw_mc_oddball.mat',...
           'mfeAdspm12meg14_0431_140218_TaskBlock1_raw_mc_oddball.mat',...
           'mfeAdspm12meg14_0430_140218_TaskBlock2_raw_mc_oddball.mat',...
           'mfeAdspm12meg14_0430_140218_TaskBlock1_raw_mc_oddball.mat',...
           'mfeAdspm12meg14_0155_140404_Oddball2_raw_mc_oddball.mat',...
           'mfeAdspm12meg14_0155_140404_Oddball1_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0545_131217_Oddball2_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0545_131217_Oddball1_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0544_131217_Oddball2_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0544_131217_Oddball1_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0540_131216_Oddball2_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0540_131216_Oddball1_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0539_131216_Oddball2_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0539_131216_Oddball1_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0502_131121_Oddball3_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0502_131121_Oddball2_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0502_131121_Oddball1_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0495_131114_Oddball2_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0495_131114_Oddball1_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0494_131114_Oddball2_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0494_131114_Oddball1_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0488_131111_Oddball2_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0488_131111_Oddball1_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0442_131010_TaskBlock2_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0442_131010_TaskBlock1_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0441_131010_TaskBlock3_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0441_131010_TaskBlock2_raw_mc_oddball.mat',...
           'mfeAdspm12meg13_0441_131010_TaskBlock1_raw_mc_oddball.mat'};

%% Weight (tease apart) by trial type (e.g. S versus D)
       
for i=1:length(filenames)
file=fullfile(base,filenames{i})

S = [];
S.D = file;
S.c = [1 0];
S.label = {'Preceding Stimulus'};
S.weighted = 0;
S.prefix = 'S'; %when saved
D = spm_eeg_contrast(S);
end;

for i=1:length(filenames)
file=fullfile(base,filenames{i})

S = [];
S.D = file;
S.c = [0 1];
S.label = {'Deviant'}; %Set the condition here
S.weighted = 0;
S.prefix = 'D';
D = spm_eeg_contrast(S);
end;
